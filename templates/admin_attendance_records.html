<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Attendance Records</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/admin_home.css" />
    <link rel="stylesheet" href="../static/admin_attendance_records.css" />
    
</head>
<body>
    <div class="image">
      <div class="burger-icon open" id="burgerIcon">&#9776;</div>
      <div class="burger-icon close" id="burgerIconClose">&#10006;</div>
      <h1 id="mobile">
        Welcome Back , <br />
        Admin {{username}}
      </h1>
      <h1 id="dekstop">Welcome Back , Admin {{username}}</h1>
      
      <a href="/logout" class="logout-btn">
        <i class="fa-solid fa-right-from-bracket"></i>&nbsp;&nbsp;Logout</a
      >
    </div>
    <div class="sidebar" id="sidebar">
      <div class="baselogo">
        <div class="logonew-icon">
          <i class="fa-solid fa-wand-sparkles"></i>
        </div>
        <h2>Admin Dashboard</h2>
      </div>
      <div class="cover_of_sidebar_links">
        <a href="{{url_for('admin_home')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="users"
              class="lucide lucide-users"
            >
              <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            Dashboard
          </div>
        </a>
        <a href="{{url_for('employee_details')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="user"
              class="lucide lucide-user"
            >
              <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Employee Management
          </div>
        </a>
        <a href="{{url_for('admin_attendance_records')}}">
          <div class="sidelink">
            <svg
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="lucide lucide-clipboard-check-attendance"
>
  <rect width="8" height="4" x="8" y="2" rx="1" ry="1" />
  <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" />
  <path d="M9 12l2 2 4-4" /> <!-- check mark for attendance -->
  <path d="M8 18h8" />       <!-- bottom line for time/notes -->
</svg>
            Attendance Records
          </div>
        </a>
        <a href="{{url_for('tasks')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="clipboard-list"
              class="lucide lucide-clipboard-list"
            >
              <rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect>
              <path
                d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"
              ></path>
              <path d="M12 11h4"></path>
              <path d="M12 16h4"></path>
              <path d="M8 11h.01"></path>
              <path d="M8 16h.01"></path>
            </svg>
            Task Tracking
          </div>
        </a>
        <a href="{{ url_for('admin_leave_requests') }}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="calendar"
              class="lucide lucide-calendar"
            >
              <path d="M8 2v4"></path>
              <path d="M16 2v4"></path>
              <rect width="18" height="18" x="3" y="4" rx="2"></rect>
              <path d="M3 10h18"></path>
            </svg>
            Leave Requests
          </div>
        </a>
        <a href="{{ url_for('performance') }}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="bar-chart-2"
              class="lucide lucide-bar-chart-2"
            >
              <line x1="18" x2="18" y1="20" y2="10"></line>
              <line x1="12" x2="12" y1="20" y2="4"></line>
              <line x1="6" x2="6" y1="20" y2="14"></line>
            </svg>
            Performance Reviews
          </div>
        </a>
        <a href="{{url_for('salary')}}" class="active">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-wallet"
            >
              <path d="M2 9.5V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v3.5"></path>
              <path d="M2 14.5V18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-3.5"></path>
              <path d="M2 9.5h20v5H2z"></path>
              <circle cx="17" cy="12" r="1"></circle>
            </svg>

            Salary Management
          </div>
        </a>
        <a href="{{url_for('admin_complaints')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="clipboard-list"
              class="lucide lucide-clipboard-list"
            >
              <rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect>
              <path
                d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"
              ></path>
              <path d="M12 11h4"></path>
              <path d="M12 16h4"></path>
              <path d="M8 11h.01"></path>
              <path d="M8 16h.01"></path>
            </svg>
            Employee Reviews
          </div>
        </a>
      </div>
    </div>

    <div class="container py-4">
        <div class="cover_attendance">
        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h3 mb-0">Attendance Records</h1>
           
        </div>
        
        <!-- Filters -->
        <div class="filter-section">
            <form method="get" class="row g-3">
                <div class="col-md-4">
                    <label for="date" class="form-label">Filter by Date</label>
                    <input type="date" class="form-control" id="date" name="date" value="{{ selected_date }}">
                </div>
                <div class="col-md-4">
                    <label for="employee" class="form-label">Filter by Employee</label>
                    <select class="form-select" id="employee" name="employee">
                        <option value="">All Employees</option>
                        {% for emp in employees %}
                            <option value="{{ emp.email }}" {% if selected_employee == emp.email %}selected{% endif %}>
                                {{ emp.username }} ({{ emp.email }})
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary me-2">
                        <i class="fas fa-filter me-2"></i>Apply Filters
                    </button>
                    <a href="{{ url_for('admin_attendance_records') }}" class="btn btn-outline-secondary">
                        <i class="fas fa-sync-alt me-2"></i>Reset
                    </a>
                </div>
            </form>
        </div>
        
        <!-- Export Button -->
        <div class="mb-3 d-flex justify-content-end">
            <a href="{{ url_for('export_attendance') }}?date={{ selected_date }}&employee={{ selected_employee }}" 
               class="export-btn">
                <i class="fas fa-file-excel me-2"></i>Export to Excel
            </a>
        </div>
        
        <!-- Attendance Records -->
        <div class="card mb-4">
            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Attendance Records</h5>
                <span class="badge bg-primary">Total: {{ total_records }}</span>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover attendance-table mb-0">
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Email</th>
                                <th>Date</th>
                                <th>Check-in</th>
                                <th>Check-out</th>
                                <th>Duration</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for record in attendance_records %}
                            <tr>
                                <td>{{ record.username }}</td>
                                <td>{{ record.email }}</td>
                                <td>{{ record.date }}</td>
                                <td>{{ record.check_in_str if record.check_in_str else '--:--:--' }}</td>
                                <td>{{ record.check_out_str if record.check_out_str else '--:--:--' }}</td>
                                <td>{{ record.duration if record.duration else 'N/A' }}</td>
                                <td>
                                    <span class="status-badge 
                                        {% if record.status == 'Present' %}badge-present
                                        {% elif record.status == 'Completed' %}badge-completed
                                        {% elif record.status == 'Leave' %}badge-leave
                                        {% else %}badge-absent{% endif %}">
                                        {{ record.status }}
                                    </span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Pagination -->
        {% if total_records > per_page %}
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
                {% if page > 1 %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('admin_attendance_records', page=page-1, date=selected_date, employee=selected_employee) }}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                {% endif %}
                
                {% for p in range(1, (total_records // per_page) + 2) %}
                    {% if p == page %}
                    <li class="page-item active">
                        <a class="page-link" href="#">{{ p }}</a>
                    </li>
                    {% else %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('admin_attendance_records', page=p, date=selected_date, employee=selected_employee) }}">{{ p }}</a>
                    </li>
                    {% endif %}
                {% endfor %}
                
                {% if page < (total_records // per_page) + 1 %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('admin_attendance_records', page=page+1, date=selected_date, employee=selected_employee) }}" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const burgerIcon = document.getElementById('burgerIcon');
      const burgerIconClose = document.getElementById('burgerIconClose');
      const sidebar = document.getElementById('sidebar');
      burgerIcon.addEventListener('click', () => {
        sidebar.classList.add('show');
        burgerIcon.style.display = 'none';
        burgerIconClose.style.display = 'block';
      });
      burgerIconClose.addEventListener('click', () => {
        sidebar.classList.remove('show');
        burgerIcon.style.display = 'block';
        burgerIconClose.style.display = 'none';
      });
    </script>
</body>
</html>