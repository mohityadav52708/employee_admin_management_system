<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leave Requests</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/admin_home.css" />
    <link rel="stylesheet" href="../static/admin_leave.css" />
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
</head>
<body>
<!-- Notification Popups -->
<div id="approvePopup" class="notification-popup">
  <i class="fas fa-check-circle"></i>
  <span>Leave request approved successfully!</span>
</div>

<div id="rejectPopup" class="notification-popup">
  <i class="fas fa-times-circle"></i>
  <span>Leave request rejected successfully!</span>
</div>
    <div class="image">

        <h1 id="mobile">Welcome Back , <br> Admin {{username}}</h1>
        <h1 id="dekstop">Welcome Back , Admin {{username}}</h1>
        <div class="burger-icon open" id="burgerIcon">&#9776;</div>
        <div class="burger-icon close" id="burgerIconClose">&#10006;</div>
        <a href="/logout" class="logout-btn">Logout</a>
    </div>
    <div class="sidebar" id="sidebar">
        <div class="baselogo">
          <div class="logonew-icon">
            <i class="fa-solid fa-wand-sparkles"></i>
          </div>
          <h2>Admin Dashboard</h2>
        </div>
        <div class="cover_of_sidebar_links">
          <a href="{{url_for('admin_home')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="users"
              class="lucide lucide-users"
            >
              <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            Dashboard
          </div>
        </a>
        <a href="{{url_for('employee_details')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="user"
              class="lucide lucide-user"
            >
              <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Employee Management
          </div>
        </a>
        <a href="{{url_for('tasks')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="clipboard-list"
              class="lucide lucide-clipboard-list"
            >
              <rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect>
              <path
                d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"
              ></path>
              <path d="M12 11h4"></path>
              <path d="M12 16h4"></path>
              <path d="M8 11h.01"></path>
              <path d="M8 16h.01"></path>
            </svg>
           Task Tracking
          </div>
        </a>
        <a href="{{ url_for('admin_leave_requests') }}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="calendar"
              class="lucide lucide-calendar"
            >
              <path d="M8 2v4"></path>
              <path d="M16 2v4"></path>
              <rect width="18" height="18" x="3" y="4" rx="2"></rect>
              <path d="M3 10h18"></path>
            </svg>
            Leave Requests
          </div>
        </a>
        <a href="{{url_for('performance')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="bar-chart-2"
              class="lucide lucide-bar-chart-2"
            >
              <line x1="18" x2="18" y1="20" y2="10"></line>
              <line x1="12" x2="12" y1="20" y2="4"></line>
              <line x1="6" x2="6" y1="20" y2="14"></line>
            </svg>
           Performance Reviews
          </div>
        </a>
        <a href="#">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="file-text"
              class="lucide lucide-file-text"
            >
              <path
                d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"
              ></path>
              <path d="M14 2v4a2 2 0 0 0 2 2h4"></path>
              <path d="M10 9H8"></path>
              <path d="M16 13H8"></path>
              <path d="M16 17H8"></path>
            </svg>
            Reports
          </div>
        </a>
        <a href="{{url_for('admin_complaints')}}">
          <div class="sidelink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              data-lucide="clipboard-list"
              class="lucide lucide-clipboard-list"
            >
              <rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect>
              <path
                d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"
              ></path>
              <path d="M12 11h4"></path>
              <path d="M12 16h4"></path>
              <path d="M8 11h.01"></path>
              <path d="M8 16h.01"></path>
            </svg>
            Employee Reviews
          </div>
        </a>
        </div>
      </div>


    
  <div class="content">
    <div class="containerone">

      {% if flash_messages %}
      <div class="flash-message">
        {% for message in flash_messages %}
        <p>{{ message }}</p>
        {% endfor %}
      </div>
      {% endif %}

      <!-- Pending Leave Requests -->
      <h2>Pending Leave Requests</h2>
      <table id="pending-table">
        <thead>
          <tr>
            <th>Employee</th>
            <th>Leave Type</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for request in leave_requests %}
          <tr>
            <td>{{ request.employee_email }}</td>
            <td>{{ request.leave_type }}</td>
            <td>{{ request.start_date }}</td>
            <td>{{ request.end_date }}</td>
            <td>{{ request.reason }}</td>
            <td>{{ request.status }}</td>
            <td>
              <form method="POST">
                <input type="hidden" name="leave_id" value="{{ request._id }}">
                <button type="submit" name="action" value="approve" class="btn-approve">Approve</button>
                <button type="submit" name="action" value="reject" class="btn-reject">Reject</button>
              </form>
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="7" style="text-align:center;">No pending leave requests.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <!-- Leave History Table -->
      <h2>Leave History (Last 15 Days)</h2>
      <table id="history-table">
        <thead>
          <tr>
            <th>Employee</th>
            <th>Leave Type</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Reason</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for history in leave_history %}
          <tr>
            <td>{{ history.employee_email }}</td>
            <td>{{ history.leave_type }}</td>
            <td>{{ history.start_date }}</td>
            <td>{{ history.end_date }}</td>
            <td>{{ history.reason }}</td>
            <td>{{ history.status }}</td>
          </tr>
          {% else %}
          <tr>
            <td colspan="6" style="text-align:center;">No leave history in the last 15 days.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

    </div>

    <div class="footer">
      <p>&copy; 2025 Admin Management System. All Rights Reserved.</p>
    </div>

  </div>
    <div id="loader" class="loader-overlay">
      <div class="loader-container">
        <div class="fancy-spinner"></div>
        <p>Processing Leave Request...</p>
      </div>
    </div>
    
    <script>
        const burgerIcon = document.getElementById('burgerIcon');
        const burgerIconClose = document.getElementById('burgerIconClose');
        const sidebar = document.getElementById('sidebar');

        burgerIcon.addEventListener('click', () => {
            sidebar.classList.add('show');
            burgerIcon.style.display = 'none';
            burgerIconClose.style.display = 'block';
        }); 

        burgerIconClose.addEventListener('click', () => {
            sidebar.classList.remove('show');
            burgerIcon.style.display = 'block';
            burgerIconClose.style.display = 'none';
        });
        document.querySelectorAll("form").forEach((form) => {
          form.addEventListener("submit", () => {
            document.getElementById("loader").classList.add("active");
          });
        });
        document.querySelectorAll("form").forEach((form) => {
          form.addEventListener("submit", function(e) {
              // Show loader
              document.getElementById("loader").classList.add("active");
              
              // Find out which button was clicked
              const action = e.submitter.value;
              
              // After loader completes (simulated with setTimeout)
              setTimeout(() => {
                  // Hide loader
                  document.getElementById("loader").classList.remove("active");
                  
                  // Show appropriate popup
                  if (action === 'approve') {
                      showPopup('approvePopup');
                  } else if (action === 'reject') {
                      showPopup('rejectPopup');
                  }
              }, 1500); // Adjust this time to match your actual loader duration
          });
      });
      
      function showPopup(popupId) {
          const popup = document.getElementById(popupId);
          popup.classList.add("show");
          
          // Hide popup after 3 seconds
          setTimeout(() => {
              popup.classList.remove("show");
          }, 3000);
      }
    </script>
</body>
</html>