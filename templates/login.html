<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="/static/login.css">
</head>
<body>
    <div class="container">
        <h2 id="loginHeading">Login/Employee</h2>
        <form method="POST" action="{{ url_for('login') }}">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" placeholder="Enter your email" required>

            <label for="password">Password:</label>
            <div class="password-container">
                <input type="password" id="password" name="password" placeholder="Enter your password" required>
                <span class="toggle-password" onclick="togglePassword()">üëÅÔ∏è</span>
            </div>

            <button type="submit">Login</button>
        </form>

        <div class="form-footer">
            <a href="{{ url_for('forgot_password') }}">Forgot Password?</a> |
            <a href="{{ url_for('signup') }}">Sign Up</a>
        </div>
        <div class="portal-option">
            <a href="#" onclick="updateHeading(event, 'Employee')">Employee Portal</a>
            <a href="#" onclick="updateHeading(event, 'Admin')">Admin Portal</a>
        </div>
    </div>
    <!-- Loader Animation -->
<div id="loaderOverlay" class="loader-overlay">
    <div class="loader-container">
      <div class="fancy-spinner"></div>
     <b> <p>Logging you in, please wait...</p></b>
    </div>
  </div>
  
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <script>
            window.onload = function() {
                {% for category, message in messages %}
                    alert("{{ message }}");
                {% endfor %}
            };
        </script>
    {% endif %}
   {% endwith %}
   
   <script>
    function updateHeading(event, portal) {
        event.preventDefault();
        document.getElementById('loginHeading').textContent = `Login/${portal}`;
        const form = document.querySelector('form');
        const currentAction = form.getAttribute('action');
        const newAction = currentAction.split('?')[0] + `?portal=${portal.toLowerCase()}`;
        form.setAttribute('action', newAction);
    }

    function togglePassword() {
        const passwordField = document.getElementById('password');
        const toggleIcon = document.querySelector('.toggle-password');
        if (passwordField.type === 'password') {
            passwordField.type = 'text';
            toggleIcon.textContent = 'üôà';
        } else {
            passwordField.type = 'password';
            toggleIcon.textContent = 'üëÅÔ∏è';
        }
    }

    {% if alert_message %}
        alert("{{ alert_message }}");
    {% endif %}

    // ‚úÖ Fancy Loader Activation on form submit
    const loginForm = document.querySelector('form');
    const loaderOverlay = document.getElementById('loaderOverlay'); // <--- important line

    loginForm.addEventListener('submit', function() {
        loaderOverlay.classList.add('active'); 
    });
</script>

</body>
</html>
