<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request Leave</title>
    <link rel="stylesheet" href="../static/home.css" />
    <link rel="stylesheet" href="../static/emp_request_leave.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="../static/home.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Success Popup Element -->
    <div id="successPopup" class="success-popup">
        <i class="fas fa-check-circle"></i>
        <span>Leave request submitted successfully!</span>
    </div>

    <div class="image" style="height:5rem;">
        <h1 id="dekstop">Welcome Back , {{username}}</h1>
        <div class="burger-icon open" id="burgerIcon">&#9776;</div>
        <div class="burger-icon close" id="burgerIconClose">&#10006;</div>
        <h1 id="mobile">Welcome Back ,<br> {{username}}</h1>
        <a href="/logout" class="logout-btn"><i class="fa-solid fa-right-from-bracket"></i>&nbsp;&nbsp;Logout</a>
    </div>
    <div class="sidebar" id="sidebar">
        <div class="baselogo">
          <div class="logonew-icon">
            <i class="fa-solid fa-user-shield"></i>
          </div>
          <h2>Employee Dashboard</h2>
        </div>
        <div class="cover_of_sidebar_links">
          <a href="{{url_for('home')}}">
            <div class="sidelink">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-home">
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
              </svg>
              Dashboard
            </div>
          </a>
          <a href="{{ url_for('profile') }}">
            <div class="sidelink">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user">
                <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
              Profile
            </div>
          </a>
          <a href="{{url_for('tasks')}}">
            <div class="sidelink">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-list">
                <rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect>
                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                <path d="M12 11h4"></path>
                <path d="M12 16h4"></path>
                <path d="M8 11h.01"></path>
                <path d="M8 16h.01"></path>
              </svg>
              Task Management
            </div>
          </a>
          <a href="{{ url_for('request_leave') }}">
            <div class="sidelink nav-item active">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar">
                <path d="M8 2v4"></path>
                <path d="M16 2v4"></path>
                <rect width="18" height="18" x="3" y="4" rx="2"></rect>
                <path d="M3 10h18"></path>
              </svg>
              Leave Management
            </div>
          </a>
          <a href="{{url_for('employee_salary')}}">
            <div class="sidelink">
              <svg xmlns="http://www.w3.org/2000/svg" 
     width="24" height="24" 
     viewBox="0 0 24 24" 
     fill="none" 
     stroke="currentColor" 
     stroke-width="2" 
     stroke-linecap="round" 
     stroke-linejoin="round" 
     class="lucide lucide-wallet">
  <path d="M2 9.5V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v3.5"></path>
  <path d="M2 14.5V18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-3.5"></path>
  <path d="M2 9.5h20v5H2z"></path>
  <circle cx="17" cy="12" r="1"></circle>
</svg>

            My Salary
            </div>
          </a>
          <a href="{{url_for('employee_attendance')}}">
            <div class="sidelink">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              Attendance
            </div>
          </a>
          <a href="{{url_for('complaints')}}">
            <div class="sidelink">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              </svg>
              Reviews
            </div>
          </a>
        </div>
    </div>
    <div class="content">
        <div class="header">
            <h1>Request Management</h1>
        </div>
    </div>  
    <div class="containerone">
        <h2>Request Leave</h2>
        {% if flash_messages %}
        <div class="flash-message">
            {% for message in flash_messages %}
            <p>{{ message }}</p>
            {% endfor %}
        </div>
        {% endif %}
        <form method="POST" id="leaveForm">
            <label for="leave_type">Leave Type:</label>
            <select name="leave_type" required>
                <option value="Sick Leave">Sick Leave</option>
                <option value="Vacation">Vacation</option>
                <option value="Personal Leave">Personal Leave</option>
            </select>

            <label for="start_date">Start Date:</label>
            <input type="date" name="start_date" required>

            <label for="end_date">End Date:</label>
            <input type="date" name="end_date" required>

            <label for="reason">Reason:</label>
            <textarea name="reason" rows="5" required></textarea>

            <button type="submit">Submit Leave Request</button>
        </form>

        <!-- Leave Request History -->
        <div class="history-section">
            <h3>Leave Request History</h3>
            {% if leave_requests %}
            <table class="history-table">
                <thead>
                    <tr>
                        <th>Leave Type</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Reason</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for leave in leave_requests %}
                    <tr>
                        <td>{{ leave.leave_type }}</td>
                        <td>{{ leave.start_date }}</td>
                        <td>{{ leave.end_date }}</td>
                        <td>{{ leave.reason }}</td>
                        <td>{{ leave.status }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p>No leave requests found.</p>
            {% endif %}
        </div>
    </div>
    <!-- Loader -->
    <div id="loader" class="loader-overlay" style="display: none;">
        <div class="loader"></div>
        <br>
        <p>Sending Leave Request...</p>
    </div>

    <script>
        // JavaScript for toggling sidebar visibility
        const burgerIcon = document.getElementById('burgerIcon');
        const burgerIconClose = document.getElementById('burgerIconClose');
        const sidebar = document.getElementById('sidebar');

        burgerIcon.addEventListener('click', () => {
            sidebar.classList.add('show');
            burgerIcon.style.display = 'none';
            burgerIconClose.style.display = 'block';
        });

        burgerIconClose.addEventListener('click', () => {
            sidebar.classList.remove('show');
            burgerIcon.style.display = 'block';
            burgerIconClose.style.display = 'none';
        });

        // Form submission with loader and success popup
        const form = document.getElementById("leaveForm");
        const loader = document.getElementById("loader");
        const successPopup = document.getElementById("successPopup");
      
        form.addEventListener("submit", function (e) {
            e.preventDefault(); // Prevent default form submission for demo
            
            // Show loader
            loader.style.display = "flex";
            
            // Simulate form submission with a delay (replace with actual form submission)
            setTimeout(() => {
                // Hide loader after processing
                loader.style.display = "none";
                
                // Show success popup
                successPopup.classList.add("show");
                
                // Hide popup after 3 seconds
                setTimeout(() => {
                    successPopup.classList.remove("show");
                    
                    // Submit the form after showing the popup (remove this if you're handling submission differently)
                    form.submit();
                }, 3000);
            }, 2000); // Simulate 2 seconds processing time
        });
      
        // Function to show success popup (can be called from other places too)
        function showSuccessPopup(message = "Leave request submitted successfully!") {
            const popup = document.getElementById("successPopup");
            popup.querySelector("span").textContent = message;
            popup.classList.add("show");
            
            setTimeout(() => {
                popup.classList.remove("show");
            }, 3000);
        }
    </script>
</body>
</html>